#1
select film.film_id, title, count(inventory.film_id) as cant 
from inventory, film 
where film.film_id = inventory.film_id
group by inventory.film_id
order by
cant desc,
title asc;

#2
select store.store_id, concat(c.first_name, " ", c.last_name) as Name, c.email, a.address, city.city, country.country
from store, customer as c, address as a, city, country
where c.store_id = store.store_id and a.address_id = c.address_id and a.city_id = city.city_id and city.country_id = country.country_id
order by Name asc

#3
select s.staff_id, concat(s.first_name, " ", s.last_name) as Name, count(r.rental_id) as Sales
from staff as s, rental as r, payment as p
where s.staff_id = r.staff_id 
and r.rental_date between '2005-06-0 00:00:00' and '2005-07-0 00:00:00'
and p.staff_id = s.staff_id
and p.rental_id = r.rental_id
group by s.staff_id
order by Sales desc

#4
select s.staff_id, concat(s.first_name, " ", s.last_name) as Name, count(r.rental_id) as Sales, sum(p.amount) as Money
from staff as s, rental as r, payment as p
where s.staff_id = r.staff_id 
and r.rental_date between '2005-06-0 00:00:00' and '2005-07-0 00:00:00'
and p.staff_id = s.staff_id
and p.rental_id = r.rental_id
group by s.staff_id
order by Money desc


#5
select r.rental_id, f.title, f.rental_duration, date(r.rental_date), date(r.return_date) as return_date, 
date(r.return_date) - date(r.rental_date) days, 
date(r.return_date) - date(r.rental_date) - f.rental_duration retraso
from rental r, inventory i, film f
where r.inventory_id = i.inventory_id
and f.film_id = i.film_id
and date(r.return_date) - date(r.rental_date) > f.rental_duration
order by retraso desc

#6
select concat(a.first_name, " ", a.last_name) as Name
from customer as c, actor as a
where a.first_name = c.first_name
and a.last_name = c.last_name

#7
select film.title, count(film.film_id) as ventas
from film, rental, inventory
where film.film_id = inventory.film_id and inventory.inventory_id  = rental.inventory_id
and rental.rental_date between '2005-06-0 00:00:00' and '2005-07-0 00:00:00' #Al filtrar no queda nada
group by film.title
having ventas > 10
order by film.title

#8
select r.rental_id, r.rental_date, 
concat(c.first_name, " ", c.last_name) as name_c, 
i.inventory_id, f.title, cat.name, p.amount, 
concat(s.first_name, " ", s.last_name) as name_s
from rental as r, customer as c, inventory as i, film as f, category as cat, film_category as fc, payment as p, staff as s
where r.customer_id = c.customer_id
and r.inventory_id = i.inventory_id
and i.film_id = f.film_id
and fc.film_id = f.film_id
and fc.category_id = cat.category_id
and r.rental_id = p.rental_id
and s.staff_id = p.staff_id

#9
create table rental_copy1 select * from rental;

#10
create table rental_copy2 select * from rental limit 0;

#11
update rental_copy1 set rental_date = timestampadd(year, 11, rental_date);

``` update rental_copy1 set return_date = timestampadd(year, 11, return_date); ``` 

#12
``` delete from rental_copy1 where customer_id between 101 and 300; ```

#13
``` insert into rental_copy2 ()
select r.*
from rental r, inventory i, film f
where r.inventory_id = i.inventory_id
and f.film_id = i.film_id
and date(r.return_date) - date(r.rental_date) > f.rental_duration ```